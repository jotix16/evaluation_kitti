<!--
  This node presents a fast and precise method to estimate the planar motion of a lidar
  from consecutive range scans. It is very useful for the estimation of the robot odometry from
  2D laser range measurements.

  For more info please visit: http://mapir.isa.uma.es/work/rf2o

  Requirements:
  - 2D laser scan, publishing sensor_msgs::LaserScan
  - TF transform from the laser to the robot base
  - MRPT (http://www.mrpt.org/)
        - Tested with v1.3 (official ubuntu release)
-->

<launch>
  <param name="/use_sim_time" value="false" />
  <arg name="rviz" default="false" />
  <arg name="bag_record" default="true" />

  <node pkg="loam_velodyne_kitti_ros" type="scanRegistrationKittiRos" name="scanRegistrationKittiRos" args="$(dirname)/2011_10_03/2011_10_03_drive_0027_sync 00" output="screen"/>

  <node pkg="loam_velodyne_kitti_ros" type="laserOdometryKittiRos" name="laserOdometryKittiRos" output="screen" required="true"/>
  <!-- <node pkg="loam_velodyne_kitti_ros" type="remap_topics.py" name="remap_topics" output="screen" respawn="true"/> -->
  <node pkg="loam_velodyne_kitti_ros" type="record_loam_odometry.py" name="record_loam_odometry" args="_path:=$(dirname)/" output="screen" required="true"/>

  <node pkg="loam_velodyne_kitti_ros" type="laserMappingKittiRos" name="laserMappingKittiRos" output="screen"/>
  <node pkg="loam_velodyne_kitti_ros" type="transformMaintenanceKittiRos" name="transformMaintenanceKittiRos" output="screen"/>

  <group if="$(arg rviz)">
    <node launch-prefix="nice" pkg="rviz" type="rviz" name="rviz" args="-d $(find loam_velodyne_kitti_ros)/rviz_cfg/loam_velodyne.rviz" />
  </group>

  <node if="$(arg bag_record)" pkg="rosbag" type="record" name="rosbagrecord" args=" /lidar/odom -O $(dirname)/bag/loam.bag" required="true" output="screen" />
</launch>